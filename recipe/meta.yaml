{% set name = "PySpice" %}
{% set version = "1.4.3" %}
#{% set sha256 = "" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  #url: https://github.com/FabriceSalvaire/PySpice/archive/v{{ version }}.tar.gz
  #sha256: {{ sha256 }}

  # Quick test for 1.4.3, even though there's no tag yet.
  git_url: https://github.com/FabriceSalvaire/PySpice
  git_rev: 910c05389ef13ea6c6b9b4cd58a55d798e7695d2

build:
  number: 0
  script:
    - {{ PYTHON }} -m pip install . -vv

requirements:
  host:
    - python
    - pip
  run:
    - python
    - pyyaml >=5.3
    - cffi >=1.14
    - numpy >=1.18
    - scipy >=1.4
    - matplotlib-base >=3.1
    - ply >=3.11
    - ngspice-lib

test:
  imports:
    - PySpice
    - PySpice.Config
    - PySpice.Doc
    - PySpice.Logging
    - PySpice.Math
    - PySpice.Physics
    - PySpice.Plot
    - PySpice.Probe
    - PySpice.Spice
    - PySpice.Tools
    - PySpice.Unit
  requires:
    - pytest
  source_files:
    - unit-test
  commands:
    - python -c "import PySpice; print(PySpice.__version__)"
    - pytest unit-test
    - pyspice_post_installation --check-install

about:
  home: https://pyspice.fabrice-salvaire.fr
  doc_url: https://pyspice.fabrice-salvaire.fr
  dev_url: https://github.com/FabriceSalvaire/PySpice

  license: GPL-3.0-or-later
  license_family: GPL
  license_file: LICENSE.txt

  summary: Simulate electronic circuit using Python and the Ngspice / Xyce simulators
  description: |
    PySpice is a free and open source Python module which interfaces Python to
    the Ngspice and Xyce circuit simulators. PySpice implements a Ngspice
    binding and provides an oriented object API on top of SPICE, the simulation
    output is converted to Numpy arrays for convenience.

extra:
  recipe-maintainers:
    - FabriceSalvaire
    - stuarteberg
